import{r as w,t as b,u as F,a as x,o as S,b as B,c as f,d as t,e as k,w as U,f as V,g as P,h as C,i as R,j as s,v as r,k as h,l as Y,p as N,m as A,n as D,q as y}from"./index-CWPSvIIf.js";function L(m,i){w(2,arguments);var d=b(m),a=b(i),n=d.getTime()-a.getTime();return n<0?-1:n>0?1:n}function _(m,i){w(2,arguments);var d=b(m),a=b(i);return d.getFullYear()-a.getFullYear()}function I(m,i){w(2,arguments);var d=b(m),a=b(i),n=L(d,a),g=Math.abs(_(d,a));d.setFullYear(1584),a.setFullYear(1584);var o=L(d,a)===-n,v=n*(g-Number(o));return v===0?0:v}const M={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},E={class:"mb-6"},T={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700"},q={class:"space-y-6"},G={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},H={class:"flex items-center"},O={class:"flex items-center"},$={key:0},j={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},W={class:"sm:col-span-2"},z={class:"sm:col-span-2"},J={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},K={class:"flex justify-end space-x-4 pt-4 border-t border-gray-200"},Q=["disabled"],X={key:0},Z={key:1},te={__name:"PersonNew",setup(m){const i=B(),d=F(),a=x(!1),n=x(null),g=x(!1),o=x({first_name:"",last_name:"",full_name:"",email:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"USA",date_of_birth:"",wedding_anniversary_date:"",generation:"",photo_url:"",is_deceased:!1});S(async()=>{d.currentUser||await d.fetchCurrentUser(),(!d.currentUser||!d.currentUser.is_admin)&&(n.value="Only administrators can add new contacts",setTimeout(()=>{i.push("/directory")},2e3))});async function v(){var c,e;a.value=!0,n.value=null;try{if(o.value.date_of_birth)try{const u=N(o.value.date_of_birth);o.value.age=I(new Date,u)}catch{}if(o.value.wedding_anniversary_date)try{const u=N(o.value.wedding_anniversary_date);o.value.years_married=I(new Date,u)}catch{}const l=(await A.post(`${D()}/persons`,o.value)).data.id;if(g.value)try{await A.post(`${D()}/households/new/set-head`,{headPersonId:l,memberIds:[l]})}catch(u){console.error("Error creating household:",u)}i.push(`/person/${l}`)}catch(p){n.value=((e=(c=p.response)==null?void 0:c.data)==null?void 0:e.error)||"Failed to create contact"}finally{a.value=!1}}return(c,e)=>{const p=P("router-link");return y(),f("div",M,[t("div",E,[k(p,{to:"/directory",class:"text-indigo-600 hover:text-indigo-800 mb-4 inline-block"},{default:U(()=>[...e[17]||(e[17]=[V(" â† Back to Directory ",-1)])]),_:1}),e[18]||(e[18]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Add New Contact",-1))]),t("form",{onSubmit:Y(v,["prevent"]),class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},[n.value?(y(),f("div",T,R(n.value),1)):C("",!0),t("div",q,[t("div",null,[e[28]||(e[28]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Basic Information",-1)),t("div",G,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700"},"First Name *",-1)),s(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.first_name=l),type:"text",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.first_name]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700"},"Last Name *",-1)),s(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.last_name=l),type:"text",required:"",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.last_name]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700"},"Full Name",-1)),s(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.full_name=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.full_name]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700"},"Generation",-1)),s(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.generation=l),type:"text",placeholder:"G1, G2, G3...",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.generation]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),s(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.email=l),type:"email",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.email]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700"},"Phone",-1)),s(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.phone=l),type:"tel",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.phone]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700"},"Date of Birth",-1)),s(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.date_of_birth=l),type:"date",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.date_of_birth]])]),t("div",H,[s(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.is_deceased=l),type:"checkbox",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[h,o.value.is_deceased]]),e[26]||(e[26]=t("label",{class:"ml-2 block text-sm font-medium text-gray-700"},"Is Deceased",-1))]),t("div",O,[s(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),type:"checkbox",class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[h,g.value]]),e[27]||(e[27]=t("label",{class:"ml-2 block text-sm font-medium text-gray-700"},"Head of Household",-1))])])]),g.value?(y(),f("div",$,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Address",-1)),t("div",j,[t("div",W,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700"},"Address Line 1",-1)),s(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.address_line1=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.address_line1]])]),t("div",z,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700"},"Address Line 2",-1)),s(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.address_line2=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.address_line2]])]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700"},"City",-1)),s(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.city=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.city]])]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700"},"State",-1)),s(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.state=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.state]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700"},"Postal Code",-1)),s(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.postal_code=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.postal_code]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700"},"Country",-1)),s(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>o.value.country=l),type:"text",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.country]])])])])):C("",!0),t("div",null,[e[37]||(e[37]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Marriage Information",-1)),t("div",J,[t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700"},"Wedding Anniversary",-1)),s(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>o.value.wedding_anniversary_date=l),type:"date",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.wedding_anniversary_date]])])])]),t("div",null,[e[40]||(e[40]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Photo",-1)),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700"},"Photo URL",-1)),s(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>o.value.photo_url=l),type:"url",placeholder:"https://...",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500"},null,512),[[r,o.value.photo_url]]),e[39]||(e[39]=t("p",{class:"mt-1 text-sm text-gray-500"},"Enter a URL to a photo",-1))])]),t("div",K,[k(p,{to:"/directory",class:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"},{default:U(()=>[...e[41]||(e[41]=[V(" Cancel ",-1)])]),_:1}),t("button",{type:"submit",disabled:a.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:opacity-50"},[a.value?(y(),f("span",X,"Creating...")):(y(),f("span",Z,"Create Contact"))],8,Q)])])],32)])}}};export{te as default};
